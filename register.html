<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<style>
    body >div {
        display: flex;
        flex-direction: column;
    }
</style>
<body>
    <div>
        <h1>register</h1>
        name
        <input type="text" class="name">
        pass
        <input type="text" class="pass">
        mail
        <input type="text" class="mail">
        role
        <input type="text" class="role">
        <button class="register">Register</button>
    </div>
<script>
    async function registerUser(email, password, name, role) {
  try {
    const data = {
      email: email,
      password: password,
      passwordConfirm: password, // Must match the password
      name: name,
      role: role,
      // You can add other optional fields here, like 'name' or 'username', if configured
    };

    const record = await pb.collection("users").create(data);

    // Optional: Immediately log in the user after successful registration
    // await pb.collection('users').authWithPassword(email, password);

    console.log("User registered successfully:", record);
    // Handle success (e.g., redirect or show a success message)

    return record;
  } catch (error) {
    console.error("Registration failed:", error);
    // Handle error (e.g., display error message to user)
    throw error;
  }
}

let name = document.querySelector(".name");
let pass = document.querySelector(".pass");
let mail = document.querySelector(".mail");
let role = document.querySelector(".role");
let register = document.querySelector(".register");


register.addEventListener("click", () => {
  registerUser(mail.value, pass.value, name.value, role.value);
});

</script>

</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pocketbase/0.21.3/pocketbase.umd.js"></script>
<script type="module" src="./main.js"></script>
</html>